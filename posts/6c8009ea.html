<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf8"><meta name="viewport" content="initial-scale=1,width=device-width"><title>手动搭建Train版OpenStack | 失落之地</title><meta name="description" content=""><meta name="keywords" content=""><link rel="apple-touch-icon" sizes="180x180" href="/images/rock-gesture.svg"><link rel="icon" type="image/png" sizes="32x32" href="/images/rock-gesture.svg"><link rel="icon" type="image/png" sizes="16x16" href="/images/rock-gesture.svg"><link rel="mask-icon" href="/images/rock-gesture.svg" color=""><style>@font-face{font-family:sourceHanSerif;src:url(/font/normal.ttf);font-weight:400}</style><style>@font-face{font-family:sourceHanSerif;src:url(/font/bold.ttf);font-weight:700}</style><link rel="stylesheet" type="text/css" href="/css/layout.css"><link rel="stylesheet" type="text/css" href="/css/post.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="search-mask" style="display:none"><div class="search-main" id="search-main"><div class="search__head"><div class="search-form"><svg t="1706347533072" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7828" width="20" height="20"><path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829"></path></svg> <input id="search-input" placeholder="搜索文章"> <svg t="1706361500528" id="search-clear" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4351" width="20" height="20"><path d="M512 562.688l-264.2944 264.2944-50.688-50.688L461.312 512 197.0176 247.7056l50.688-50.688L512 461.312l264.2944-264.2944 50.688 50.688L562.688 512l264.2944 264.2944-50.688 50.688L512 562.688z" fill="#00" p-id="4352"></path></svg></div></div><div class="search__body" id="search-result"></div><div class="search__foot"></div></div></div><div class="head"><div class="nav"><a href="/" class="nav-logo"><img alt="logo" height="60px" width="60px" src="/images/rock-gesture.svg"> </a><input id="navBtn" type="checkbox"><div class="nav-right"><div class="search-outer"><div class="search" id="search-btn"><svg t="1706347533072" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7828" width="20" height="20"><path d="M685.6 660.336l155.152 155.168a16 16 0 0 1 0 22.624l-11.312 11.328a16 16 0 0 1-22.624 0l-158.528-158.544a289.792 289.792 0 0 1-165.152 51.36C322.336 742.256 192 611.904 192 451.12 192 290.336 322.336 160 483.136 160c160.784 0 291.12 130.336 291.12 291.136 0 82.112-33.984 156.272-88.672 209.2z m-202.464 33.92c134.272 0 243.12-108.848 243.12-243.12C726.256 316.848 617.408 208 483.136 208 348.848 208 240 316.848 240 451.136c0 134.272 108.848 243.12 243.136 243.12z" fill="#000000" p-id="7829"></path></svg> <span>搜索</span> <span class="search-shortcut-key">Ctrl K</span></div></div><div class="nav-menu"><a class="nav-menu-item" href="/devops">運維</a> <a class="nav-menu-item" href="/playlist">歌單</a> <a class="nav-menu-item" href="/cv/">简历</a></div></div><label class="nav-btn" for="navBtn"></label></div></div><div class="body"><article class="post-content"><div class="post-inner--toc"><div class="post-content__head"><div class="post-title">手动搭建Train版OpenStack</div><div class="post-info"><a href="/tags/openstack/" class="post-tag">#openstack</a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" class="post-tag">#虚拟化</a> <span class="post-date">2022-12-22</span></div></div><aside class="toc-outer"><div class="toc-title">目录</div><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#enviroment"><span class="post-toc-text">Enviroment</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#prerequisites"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#network-time-protoco"><span class="post-toc-text">Network Time Protoco</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#controller"><span class="post-toc-text">controller</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#computerblock"><span class="post-toc-text">computer,block</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#openstack-packages"><span class="post-toc-text">OpenStack packages</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql-database"><span class="post-toc-text">SQL database</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#message-queue"><span class="post-toc-text">Message queue</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#memcached"><span class="post-toc-text">Memcached</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etcd"><span class="post-toc-text">Etcd</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#keystone-installation-for-train"><span class="post-toc-text">Keystone installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#prerequisites-2"><span class="post-toc-text">Prerequisites</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#install-and-configure-components"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#configure-the-apache-http-server"><span class="post-toc-text">Configure the Apache HTTP server</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#finalize-the-installation"><span class="post-toc-text">Finalize the installation</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#create-a-domain-projects-users-and-roles"><span class="post-toc-text">Create a domain, projects, users, and roles</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#verify-operation"><span class="post-toc-text">Verify operation</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#glance-installation-for-train"><span class="post-toc-text">Glance installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#prerequisites-3"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#create-database"><span class="post-toc-text">Create Database</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#configure-user-and-endpoints"><span class="post-toc-text">Configure User and Endpoints</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#install-and-configure-components-2"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#verify-operation-2"><span class="post-toc-text">Verify operation</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#placement-installation-for-train"><span class="post-toc-text">Placement installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#prerequisites-4"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#create-database-2"><span class="post-toc-text">Create Database</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#configure-user-and-endpoints-2"><span class="post-toc-text">Configure User and Endpoints</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#install-and-configure-components-3"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#verify-operation-3"><span class="post-toc-text">Verify operation</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#nova-installation-for-train"><span class="post-toc-text">Nova installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#controller-2"><span class="post-toc-text">controller</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#prerequisites-5"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#create-database-3"><span class="post-toc-text">Create Database</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#configure-user-and-endpoints-3"><span class="post-toc-text">Configure User and Endpoints</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-4"><span class="post-toc-text">Install and configure components</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#compute"><span class="post-toc-text">compute</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-5"><span class="post-toc-text">Install and configure components</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#controller-3"><span class="post-toc-text">controller</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#verify-operation-4"><span class="post-toc-text">Verify operation</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#neutron-installation-for-train"><span class="post-toc-text">Neutron installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#controller-4"><span class="post-toc-text">controller</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#prerequisites-6"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#create-database-4"><span class="post-toc-text">Create Database</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#configure-user-and-endpoints-4"><span class="post-toc-text">Configure User and Endpoints</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-6"><span class="post-toc-text">Install and configure components</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#provider-networks"><span class="post-toc-text">Provider networks</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#finalize-installation"><span class="post-toc-text">Finalize installation</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#compute-2"><span class="post-toc-text">compute</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-7"><span class="post-toc-text">Install and configure components</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#vim-etcneutronneutronconf-2"><span class="post-toc-text">vim &#x2F;etc&#x2F;neutron&#x2F;neutron.conf</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#provider-networks-2"><span class="post-toc-text">Provider networks</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#vim-etcnovanovaconf-2"><span class="post-toc-text">vim &#x2F;etc&#x2F;nova&#x2F;nova.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#finalize-installation-2"><span class="post-toc-text">Finalize installation</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#verify-operation-5"><span class="post-toc-text">Verify operation</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#provider-networks-3"><span class="post-toc-text">Provider networks</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#self-service-networks"><span class="post-toc-text">Self-service networks</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#cinder-installation-for-train"><span class="post-toc-text">Cinder installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#controller-5"><span class="post-toc-text">controller</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#prerequisites-7"><span class="post-toc-text">Prerequisites</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#create-database-5"><span class="post-toc-text">Create Database</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#configure-user-and-endpoints-5"><span class="post-toc-text">Configure User and Endpoints</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-8"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#configure-compute-to-use-block-storage"><span class="post-toc-text">Configure Compute to use Block Storage[</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#finalize-installation-3"><span class="post-toc-text">Finalize installation</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#block"><span class="post-toc-text">block</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#prerequisites-8"><span class="post-toc-text">Prerequisites</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#install-and-configure-components-9"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#finalize-installation-4"><span class="post-toc-text">Finalize installation</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#verify-cinder-operation"><span class="post-toc-text">Verify Cinder operation</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#horizon-installation-for-train"><span class="post-toc-text">Horizon installation for Train</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#install-and-configure-components-10"><span class="post-toc-text">Install and configure components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#finalize-installation-5"><span class="post-toc-text">Finalize installation</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#launch-an-instance%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87-dashboard-%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">Launch an instance（可以通过 dashboard 实现）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#create-virtual-networks"><span class="post-toc-text">Create virtual networks</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#provider-network"><span class="post-toc-text">Provider network</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#self-service-network"><span class="post-toc-text">Self-service network</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#create-m1nano-flavor"><span class="post-toc-text">Create m1.nano flavor</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#generate-a-key-pair"><span class="post-toc-text">Generate a key pair</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#add-security-group-rules"><span class="post-toc-text">Add security group rules</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#launch-an-instance"><span class="post-toc-text">Launch an instance</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#provider-network-2"><span class="post-toc-text">Provider network</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#self-service-network-2"><span class="post-toc-text">Self-service network</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BE%8B%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81controller"><span class="post-toc-text">修改实例默认密码(controller)</span></a></li></ol></li></ol><a href="#" class="toc-top">回到顶部</a></aside><div class="post-content__body"><div class="post-gallery"></div><blockquote><p>  学习搭建 <code>OpenStack</code></p></blockquote><h1 id="enviroment"><a class="markdownIt-Anchor" href="#enviroment"></a> Enviroment</h1><table><thead><tr><th style="text-align:center">hostname</th><th style="text-align:center">os</th><th style="text-align:center">static ip</th><th style="text-align:center">role</th></tr></thead><tbody><tr><td style="text-align:center">controller</td><td style="text-align:center">centos7.8</td><td style="text-align:center">网卡 1Nat 模式静态 10.10.10.101；网卡 2 仅主机模式不设 IP，网关地址 192.168.40.1</td><td style="text-align:center">主控</td></tr><tr><td style="text-align:center">computer</td><td style="text-align:center">centos7.8</td><td style="text-align:center">网卡 1Nat 模式静态 10.10.10.102；网卡 2 仅主机模式不设 IP，网关地址 192.168.40.1</td><td style="text-align:center">计算</td></tr><tr><td style="text-align:center">block</td><td style="text-align:center">centos7.8</td><td style="text-align:center">10.10.10.103</td><td style="text-align:center">块储存，双硬盘</td></tr></tbody></table><h1 id="prerequisites"><a class="markdownIt-Anchor" href="#prerequisites"></a> Prerequisites</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">临时关闭防火墙</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">禁用防火墙，重启生效</span></span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">临时关闭selinux</span></span><br><span class="line">setenforce 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">禁用selinux,重启生效</span></span><br><span class="line">sed -i &quot;s/enforcing/disabled/g&quot; /etc/selinux/config</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装常用软件包</span></span><br><span class="line">yum install vim net-tools lrzsz unzip dos2unix telnet sysstat iotop pciutils lsof tcpdump psmisc bc wget socat gcc tree chrony ntpdate -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主机名写入hosts</span></span><br><span class="line">sed -i &#x27;$a\10.10.10.101 controller\n10.10.10.102 compute\n10.10.10.103 block&#x27; /etc/hosts</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主机间配置ssh免密登录</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">for host in master backup node ; do ssh-copy-id -i ~/.ssh/id_rsa.pub $host;done</span><br></pre></td></tr></table></figure><h2 id="network-time-protoco"><a class="markdownIt-Anchor" href="#network-time-protoco"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-ntp.html#">Network Time Protoco</a></h2><h3 id="controller"><a class="markdownIt-Anchor" href="#controller"></a> controller</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install chrony -y</span><br><span class="line"></span><br><span class="line">vim /etc/chrony.conf</span><br><span class="line">allow 10.10.0.0/16 (主控节点网段)</span><br><span class="line"></span><br><span class="line">for op in enable restart status;do systemctl $op chronyd;done</span><br></pre></td></tr></table></figure><h3 id="computerblock"><a class="markdownIt-Anchor" href="#computerblock"></a> computer,block</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install chrony -y</span><br><span class="line"></span><br><span class="line">vim /etc/chrony.conf</span><br><span class="line">server controller iburst</span><br><span class="line"></span><br><span class="line">for op in enable restart status;do systemctl $op chronyd;done</span><br></pre></td></tr></table></figure><h2 id="openstack-packages"><a class="markdownIt-Anchor" href="#openstack-packages"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-packages.html#">OpenStack packages</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum list centos-release-openstack*</span><br><span class="line">yum install centos-release-openstack-train -y</span><br><span class="line">yum upgrade -y</span><br><span class="line">yum install python-openstackclient openstack-selinux -y</span><br></pre></td></tr></table></figure><h2 id="sql-database"><a class="markdownIt-Anchor" href="#sql-database"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-sql-database.html">SQL database</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb mariadb-server python2-PyMySQL -y</span><br><span class="line"></span><br><span class="line">vim /etc/my.cnf.d/openstack.conf</span><br><span class="line">[mysqld]</span><br><span class="line">bind-address = 10.10.10.101</span><br><span class="line"></span><br><span class="line">default-storage-engine = innodb</span><br><span class="line">innodb_file_per_table = on</span><br><span class="line">max_connections = 4096</span><br><span class="line">collation-server = utf8_general_ci</span><br><span class="line">character-set-server = utf8</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op mariadb;done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">数据库初始化，需要设置密码</span></span><br><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure><h2 id="message-queue"><a class="markdownIt-Anchor" href="#message-queue"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-messaging.html">Message queue</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">yum install rabbitmq-server -y</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op rabbitmq-server;done</span><br><span class="line"></span><br><span class="line">rabbitmqctl add_user openstack openstack</span><br><span class="line"></span><br><span class="line">rabbitmqctl set_permissions openstack &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装可视化插件</span></span><br><span class="line">rabbitmq-plugins enable rabbitmq-management</span><br><span class="line">systemctl restart rabbitmq-server</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">访问http://主控节点IP:15672/，登录账户guest/guest，将刚建的openstack用户加入到管理组</span></span><br></pre></td></tr></table></figure><h2 id="memcached"><a class="markdownIt-Anchor" href="#memcached"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-memcached.html">Memcached</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install memcached python-memcached -y</span><br><span class="line"></span><br><span class="line">sed -i &#x27;s/127.0.0.1/10.10.10.101/&#x27; /etc/sysconfig/memcached</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op memcached;done</span><br></pre></td></tr></table></figure><h2 id="etcd"><a class="markdownIt-Anchor" href="#etcd"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/install-guide/environment-etcd.html">Etcd</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yum install etcd -y</span><br><span class="line"></span><br><span class="line">vim /etc/etcd/etcd.conf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">[Member]</span></span><br><span class="line">ETCD_DATA_DIR=&quot;/var/lib/etcd/default.etcd&quot;</span><br><span class="line">ETCD_LISTEN_PEER_URLS=&quot;http://10.10.10.101:2380&quot;</span><br><span class="line">ETCD_LISTEN_CLIENT_URLS=&quot;http://10.10.10.101:2379&quot;</span><br><span class="line">ETCD_NAME=&quot;controller&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">[Clustering]</span></span><br><span class="line">ETCD_INITIAL_ADVERTISE_PEER_URLS=&quot;http://10.10.10.101:2380&quot;</span><br><span class="line">ETCD_ADVERTISE_CLIENT_URLS=&quot;http://10.10.10.101:2379&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER=&quot;controller=http://10.10.10.101:2380&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER_TOKEN=&quot;etcd-cluster-01&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER_STATE=&quot;new&quot;</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op etcd;done</span><br></pre></td></tr></table></figure><h1 id="keystone-installation-for-train"><a class="markdownIt-Anchor" href="#keystone-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/keystone/train/install/">Keystone installation for Train</a></h1><h2 id="prerequisites-2"><a class="markdownIt-Anchor" href="#prerequisites-2"></a> Prerequisites</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE keystone;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON keystone.* TO &#x27;keystone&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;keystone&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON keystone.* TO &#x27;keystone&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;keystone&#x27;;</span><br><span class="line"></span><br><span class="line">exit;</span><br></pre></td></tr></table></figure><h2 id="install-and-configure-components"><a class="markdownIt-Anchor" href="#install-and-configure-components"></a> Install and configure components</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-keystone httpd mod_wsgi -y</span><br><span class="line"></span><br><span class="line">cp /etc/keystone/keystone.conf /etc/keystone/keystone.conf.bak</span><br><span class="line"></span><br><span class="line">vim /etc/keystone/keystone.conf</span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://keystone:keystone@controller/keystone</span><br><span class="line">[token]</span><br><span class="line">provider = fernet</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;keystone-manage db_sync&quot; keystone</span><br><span class="line"></span><br><span class="line">keystone-manage fernet_setup --keystone-user keystone --keystone-group keystone</span><br><span class="line">keystone-manage credential_setup --keystone-user keystone --keystone-group keystone</span><br><span class="line"></span><br><span class="line">keystone-manage bootstrap --bootstrap-password admin(管理员密码) \</span><br><span class="line">  --bootstrap-admin-url http://controller:5000/v3/ \</span><br><span class="line">  --bootstrap-internal-url http://controller:5000/v3/ \</span><br><span class="line">  --bootstrap-public-url http://controller:5000/v3/ \</span><br><span class="line">  --bootstrap-region-id RegionOne</span><br></pre></td></tr></table></figure><h2 id="configure-the-apache-http-server"><a class="markdownIt-Anchor" href="#configure-the-apache-http-server"></a> Configure the Apache HTTP server</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/httpd/conf/httpd.conf</span><br><span class="line">ServerName controller(主机名)</span><br><span class="line"></span><br><span class="line">ln -s /usr/share/keystone/wsgi-keystone.conf /etc/httpd/conf.d/</span><br></pre></td></tr></table></figure><h2 id="finalize-the-installation"><a class="markdownIt-Anchor" href="#finalize-the-installation"></a> Finalize the installation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">for op in enable start status;do systemctl $op httpd;done</span><br><span class="line"></span><br><span class="line">vim admin-openrc</span><br><span class="line">export OS_USERNAME=admin</span><br><span class="line">export OS_PASSWORD=Aadmin(管理员密码)</span><br><span class="line">export OS_PROJECT_NAME=admin</span><br><span class="line">export OS_USER_DOMAIN_NAME=Default</span><br><span class="line">export OS_PROJECT_DOMAIN_NAME=Default</span><br><span class="line">export OS_AUTH_URL=http://controller:5000/v3</span><br><span class="line">export OS_IDENTITY_API_VERSION=3</span><br><span class="line"></span><br><span class="line">source admin-openrc</span><br></pre></td></tr></table></figure><h2 id="create-a-domain-projects-users-and-roles"><a class="markdownIt-Anchor" href="#create-a-domain-projects-users-and-roles"></a> Create a domain, projects, users, and roles</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">openstack domain create --description &quot;An Example Domain&quot; example</span><br><span class="line"></span><br><span class="line">openstack project create --domain default \</span><br><span class="line">  --description &quot;Service Project&quot; service</span><br><span class="line"></span><br><span class="line">openstack project create --domain default \</span><br><span class="line">  --description &quot;Demo Project&quot; myproject</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置普通用户密码</span></span><br><span class="line">openstack user create --domain default \</span><br><span class="line">  --password-prompt myuser</span><br><span class="line"></span><br><span class="line">openstack role create myrole</span><br><span class="line"></span><br><span class="line">openstack role add --project myproject --user myuser myrole</span><br></pre></td></tr></table></figure><h2 id="verify-operation"><a class="markdownIt-Anchor" href="#verify-operation"></a> Verify operation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">unset OS_AUTH_URL OS_PASSWORD</span><br><span class="line"></span><br><span class="line">openstack --os-auth-url http://controller:5000/v3 \</span><br><span class="line">  --os-project-domain-name Default --os-user-domain-name Default \</span><br><span class="line">  --os-project-name admin --os-username admin token issue</span><br><span class="line"></span><br><span class="line">openstack --os-auth-url http://controller:5000/v3 \</span><br><span class="line">  --os-project-domain-name Default --os-user-domain-name Default \</span><br><span class="line">  --os-project-name myproject --os-username myuser token issue</span><br><span class="line"></span><br><span class="line">vim demo-openrc</span><br><span class="line">export OS_PROJECT_DOMAIN_NAME=Default</span><br><span class="line">export OS_USER_DOMAIN_NAME=Default</span><br><span class="line">export OS_PROJECT_NAME=myproject</span><br><span class="line">export OS_USERNAME=myuser</span><br><span class="line">export OS_PASSWORD=demo(普通用户密码)</span><br><span class="line">export OS_AUTH_URL=http://controller:5000/v3</span><br><span class="line">export OS_IDENTITY_API_VERSION=3</span><br><span class="line">export OS_IMAGE_API_VERSION=2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看普通用户token信息</span></span><br><span class="line">source demo-openrc</span><br><span class="line">openstack token issue</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看管理员token信息</span></span><br><span class="line">source admin-openrc</span><br><span class="line">openstack token issue</span><br></pre></td></tr></table></figure><h1 id="glance-installation-for-train"><a class="markdownIt-Anchor" href="#glance-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/glance/train/install/">Glance installation for Train</a></h1><h2 id="prerequisites-3"><a class="markdownIt-Anchor" href="#prerequisites-3"></a> Prerequisites</h2><h3 id="create-database"><a class="markdownIt-Anchor" href="#create-database"></a> Create Database</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE glance;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON glance.* TO &#x27;glance&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;glance&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON glance.* TO &#x27;glance&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;glance&#x27;;</span><br><span class="line"></span><br><span class="line">exit;</span><br></pre></td></tr></table></figure><h3 id="configure-user-and-endpoints"><a class="markdownIt-Anchor" href="#configure-user-and-endpoints"></a> Configure User and Endpoints</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置glance用户密码</span></span><br><span class="line">openstack user create --domain default --password-prompt glance</span><br><span class="line"></span><br><span class="line">openstack role add --project service --user glance admin</span><br><span class="line"></span><br><span class="line">openstack service create --name glance \</span><br><span class="line">  --description &quot;OpenStack Image&quot; image</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  image public http://controller:9292</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  image internal http://controller:9292</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  image admin http://controller:9292</span><br></pre></td></tr></table></figure><h2 id="install-and-configure-components-2"><a class="markdownIt-Anchor" href="#install-and-configure-components-2"></a> Install and configure components</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-glance -y</span><br><span class="line"></span><br><span class="line">cp /etc/glance/glance-api.conf /etc/glance/glance-api.conf.bak</span><br><span class="line">vim /etc/glance/glance-api.conf</span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://glance:glance@controller/glance</span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri  = http://controller:5000</span><br><span class="line">auth_url = http://controller:5000</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = Default</span><br><span class="line">user_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">username = glance</span><br><span class="line">password = glance(glance用户密码)</span><br><span class="line">[paste_deploy]</span><br><span class="line">flavor = keystone</span><br><span class="line">[glance_store]</span><br><span class="line">stores = file,http</span><br><span class="line">default_store = file</span><br><span class="line">filesystem_store_datadir = /var/lib/glance/images/</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;glance-manage db_sync&quot; glance</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op openstack-glance-api;done</span><br></pre></td></tr></table></figure><h2 id="verify-operation-2"><a class="markdownIt-Anchor" href="#verify-operation-2"></a> Verify operation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img</span><br><span class="line"></span><br><span class="line">glance image-create --name &quot;cirros&quot; \</span><br><span class="line">  --file cirros-0.4.0-x86_64-disk.img \</span><br><span class="line">  --disk-format qcow2 --container-format bare \</span><br><span class="line">  --visibility public</span><br><span class="line"></span><br><span class="line">glance image-create --name &quot;Centos7&quot; \</span><br><span class="line">  --file CentOS-7-x86_64-GenericCloud-2003.qcow2c \</span><br><span class="line">  --disk-format qcow2 --container-format bare \</span><br><span class="line">  --visibility public</span><br><span class="line"></span><br><span class="line">openstack images list</span><br></pre></td></tr></table></figure><h1 id="placement-installation-for-train"><a class="markdownIt-Anchor" href="#placement-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/placement/train/install/">Placement installation for Train</a></h1><h2 id="prerequisites-4"><a class="markdownIt-Anchor" href="#prerequisites-4"></a> Prerequisites</h2><h3 id="create-database-2"><a class="markdownIt-Anchor" href="#create-database-2"></a> Create Database</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE placement;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON placement.* TO &#x27;placement&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;placement&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON placement.* TO &#x27;placement&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;placement&#x27;;</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure><h3 id="configure-user-and-endpoints-2"><a class="markdownIt-Anchor" href="#configure-user-and-endpoints-2"></a> Configure User and Endpoints</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置placement用户密码</span></span><br><span class="line">openstack user create --domain default --password-prompt placement</span><br><span class="line"></span><br><span class="line">openstack role add --project service --user placement admin</span><br><span class="line"></span><br><span class="line">openstack service create --name placement \</span><br><span class="line">  --description &quot;Placement API&quot; placement</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  placement public http://controller:8778</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  placement internal http://controller:8778</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  placement admin http://controller:8778</span><br></pre></td></tr></table></figure><h2 id="install-and-configure-components-3"><a class="markdownIt-Anchor" href="#install-and-configure-components-3"></a> Install and configure components</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-placement-api -y</span><br><span class="line"></span><br><span class="line">cp /etc/placement/placement.conf /etc/placement/placement.conf.bak</span><br><span class="line">vim /etc/placement/placement.conf</span><br><span class="line">[placement_database]</span><br><span class="line">connection = mysql+pymysql://placement:placement@controller/placement</span><br><span class="line">[api]</span><br><span class="line">auth_strategy = keystone</span><br><span class="line">[keystone_authtoken]</span><br><span class="line">auth_url = http://controller:5000/v3</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = Default</span><br><span class="line">user_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">username = placement</span><br><span class="line">password = placement(placement用户密码)</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;placement-manage db sync&quot; placement</span><br><span class="line"></span><br><span class="line">systemctl restart httpd &amp; systemctl status httpd</span><br></pre></td></tr></table></figure><h2 id="verify-operation-3"><a class="markdownIt-Anchor" href="#verify-operation-3"></a> Verify operation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"></span><br><span class="line">placement-status upgrade check</span><br><span class="line"></span><br><span class="line">yum install epel-release -y</span><br><span class="line">yum install -y python-pip</span><br><span class="line">pip install --upgrade pip</span><br><span class="line">pip install osc-placement</span><br><span class="line"></span><br><span class="line">openstack --os-placement-api-version 1.2 resource class list --sort-column name</span><br><span class="line">openstack --os-placement-api-version 1.6 trait list --sort-column name</span><br></pre></td></tr></table></figure><h1 id="nova-installation-for-train"><a class="markdownIt-Anchor" href="#nova-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/nova/train/install/">Nova installation for Train</a></h1><h2 id="controller-2"><a class="markdownIt-Anchor" href="#controller-2"></a> controller</h2><h3 id="prerequisites-5"><a class="markdownIt-Anchor" href="#prerequisites-5"></a> Prerequisites</h3><h4 id="create-database-3"><a class="markdownIt-Anchor" href="#create-database-3"></a> Create Database</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE nova_api;</span><br><span class="line">CREATE DATABASE nova;</span><br><span class="line">CREATE DATABASE nova_cell0;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON nova_api.* TO &#x27;nova&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON nova_api.* TO &#x27;nova&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON nova.* TO &#x27;nova&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON nova.* TO &#x27;nova&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON nova_cell0.* TO &#x27;nova&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON nova_cell0.* TO &#x27;nova&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;nova&#x27;;</span><br><span class="line"></span><br><span class="line">exit;</span><br></pre></td></tr></table></figure><h4 id="configure-user-and-endpoints-3"><a class="markdownIt-Anchor" href="#configure-user-and-endpoints-3"></a> Configure User and Endpoints</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置nova用户密码</span></span><br><span class="line">openstack user create --domain default --password-prompt nova</span><br><span class="line"></span><br><span class="line">openstack role add --project service --user nova admin</span><br><span class="line"></span><br><span class="line">openstack service create --name nova \</span><br><span class="line">  --description &quot;OpenStack Compute&quot; compute</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  compute public http://controller:8774/v2.1</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  compute internal http://controller:8774/v2.1</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  compute admin http://controller:8774/v2.1</span><br></pre></td></tr></table></figure><h3 id="install-and-configure-components-4"><a class="markdownIt-Anchor" href="#install-and-configure-components-4"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-nova-api openstack-nova-conductor \</span><br><span class="line">  openstack-nova-novncproxy openstack-nova-scheduler -y</span><br><span class="line">cp /etc/nova/nova.conf /etc/nova/nova.conf.bak</span><br><span class="line">vim /etc/nova/nova.conf</span><br><span class="line">[DEFAULT]</span><br><span class="line">enabled_apis = osapi_compute,metadata</span><br><span class="line">transport_url = rabbit://openstack:openstack@controller:5672/</span><br><span class="line">my_ip = 10.10.10.101(主控节点IP)</span><br><span class="line">use_neutron = true</span><br><span class="line">firewall_driver = nova.virt.firewall.NoopFirewallDriver</span><br><span class="line"></span><br><span class="line">[api_database]</span><br><span class="line">connection = mysql+pymysql://nova:nova@controller/nova_api</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://nova:nova@controller/nova</span><br><span class="line"></span><br><span class="line">[api]</span><br><span class="line">auth_strategy = keystone</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://controller:5000/</span><br><span class="line">auth_url = http://controller:5000/</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = Default</span><br><span class="line">user_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">username = nova</span><br><span class="line">password = nova(nova用户密码)</span><br><span class="line"></span><br><span class="line">[vnc]</span><br><span class="line">enabled = true</span><br><span class="line">server_listen = $my_ip</span><br><span class="line">server_proxyclient_address = $my_ip</span><br><span class="line"></span><br><span class="line">[glance]</span><br><span class="line">api_servers = http://controller:9292</span><br><span class="line"></span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/nova/tmp</span><br><span class="line"></span><br><span class="line">[placement]</span><br><span class="line">region_name = RegionOne</span><br><span class="line">project_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">auth_type = password</span><br><span class="line">user_domain_name = Default</span><br><span class="line">auth_url = http://controller:5000/v3</span><br><span class="line">username = placement</span><br><span class="line">password = placement(placement用户密码)</span><br><span class="line"></span><br><span class="line">[scheduler]</span><br><span class="line">discover_hosts_in_cells_interval = 300</span><br><span class="line"></span><br><span class="line">vim /etc/httpd/conf.d/00-nova-placement-api.conf</span><br><span class="line">&lt;Directory /usr/bin&gt;</span><br><span class="line">   &lt;IfVersion &gt;= 2.4&gt;</span><br><span class="line">      Require all granted</span><br><span class="line">   &lt;/IfVersion&gt;</span><br><span class="line">   &lt;IfVersion &lt; 2.4&gt;</span><br><span class="line">      Order allow,deny</span><br><span class="line">      Allow from all</span><br><span class="line">   &lt;/IfVersion&gt;</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;nova-manage api_db sync&quot; nova</span><br><span class="line">su -s /bin/sh -c &quot;nova-manage cell_v2 map_cell0&quot; nova</span><br><span class="line">su -s /bin/sh -c &quot;nova-manage cell_v2 create_cell --name=cell1 --verbose&quot; nova</span><br><span class="line">su -s /bin/sh -c &quot;nova-manage db sync&quot; nova</span><br><span class="line">su -s /bin/sh -c &quot;nova-manage cell_v2 list_cells&quot; nova</span><br><span class="line"></span><br><span class="line">for op in enable satrt status;do for service in openstack-nova-api openstack-nova-scheduler openstack-nova-conductor openstack-nova-novncproxy;do systemctl $op $service;done;done</span><br></pre></td></tr></table></figure><h2 id="compute"><a class="markdownIt-Anchor" href="#compute"></a> compute</h2><h3 id="install-and-configure-components-5"><a class="markdownIt-Anchor" href="#install-and-configure-components-5"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-nova-compute libvirt -y</span><br><span class="line"></span><br><span class="line">cp /etc/nova/nova.conf /etc/nova/nova.conf.bak</span><br><span class="line">vim /etc/nova/nova.conf</span><br><span class="line">[DEFAULT]</span><br><span class="line">enabled_apis = osapi_compute,metadata</span><br><span class="line">transport_url = rabbit://openstack:openstack@controller</span><br><span class="line">my_ip = 10.10.10.102(计算节点IP)</span><br><span class="line">use_neutron = true</span><br><span class="line">firewall_driver = nova.virt.firewall.NoopFirewallDriver</span><br><span class="line"></span><br><span class="line">[api]</span><br><span class="line">auth_strategy = keystone</span><br><span class="line"></span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://controller:5000/</span><br><span class="line">auth_url = http://controller:5000/</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = Default</span><br><span class="line">user_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">username = nova</span><br><span class="line">password = nova(nova用户密码)</span><br><span class="line"></span><br><span class="line">[vnc]</span><br><span class="line">enabled = true</span><br><span class="line">server_listen = 0.0.0.0</span><br><span class="line">server_proxyclient_address = $my_ip</span><br><span class="line">novncproxy_base_url = http://controller:6080/vnc_auto.html</span><br><span class="line"></span><br><span class="line">[glance]</span><br><span class="line">api_servers = http://controller:9292</span><br><span class="line"></span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/nova/tmp</span><br><span class="line"></span><br><span class="line">[placement]</span><br><span class="line">region_name = RegionOne</span><br><span class="line">project_domain_name = Default</span><br><span class="line">project_name = service</span><br><span class="line">auth_type = password</span><br><span class="line">user_domain_name = Default</span><br><span class="line">auth_url = http://controller:5000/v3</span><br><span class="line">username = placement</span><br><span class="line">password = placement(placement用户密码)</span><br><span class="line"></span><br><span class="line">[libvirt]</span><br><span class="line">cpu_mode = none</span><br><span class="line">virt_type=qemu</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for op in enable satrt status;do for service in libvirtd openstack-nova-compute;do systemctl $op $service;done;done</span><br></pre></td></tr></table></figure><h2 id="controller-3"><a class="markdownIt-Anchor" href="#controller-3"></a> controller</h2><h3 id="verify-operation-4"><a class="markdownIt-Anchor" href="#verify-operation-4"></a> Verify operation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line">openstack compute service list</span><br><span class="line">su -s /bin/sh -c &quot;nova-manage cell_v2 discover_hosts --verbose&quot; nova</span><br></pre></td></tr></table></figure><h1 id="neutron-installation-for-train"><a class="markdownIt-Anchor" href="#neutron-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/train/install/">Neutron installation for Train</a></h1><h2 id="controller-4"><a class="markdownIt-Anchor" href="#controller-4"></a> controller</h2><h3 id="prerequisites-6"><a class="markdownIt-Anchor" href="#prerequisites-6"></a> Prerequisites</h3><h4 id="create-database-4"><a class="markdownIt-Anchor" href="#create-database-4"></a> Create Database</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE neutron;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON neutron.* TO &#x27;neutron&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;neutron&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON neutron.* TO &#x27;neutron&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;neutron&#x27;;</span><br><span class="line"></span><br><span class="line">exit;</span><br></pre></td></tr></table></figure><h4 id="configure-user-and-endpoints-4"><a class="markdownIt-Anchor" href="#configure-user-and-endpoints-4"></a> Configure User and Endpoints</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置neutron用户密码</span></span><br><span class="line">openstack user create --domain default --password-prompt neutron</span><br><span class="line"></span><br><span class="line">openstack role add --project service --user neutron admin</span><br><span class="line"></span><br><span class="line">openstack service create --name neutron \</span><br><span class="line">  --description &quot;OpenStack Networking&quot; network</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  network public http://controller:9696</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  network internal http://controller:9696</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  network admin http://controller:9696</span><br></pre></td></tr></table></figure><h3 id="install-and-configure-components-6"><a class="markdownIt-Anchor" href="#install-and-configure-components-6"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-neutron openstack-neutron-ml2 \</span><br><span class="line">  openstack-neutron-linuxbridge ebtables -y</span><br></pre></td></tr></table></figure><h4 id="provider-networks"><a class="markdownIt-Anchor" href="#provider-networks"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/train/install/controller-install-option1-rdo.html">Provider networks</a></h4><h5 id="vim-etcneutronneutronconf"><a class="markdownIt-Anchor" href="#vim-etcneutronneutronconf"></a> vim /etc/neutron/neutron.conf</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[database]</span></span><br><span class="line"><span class="attr">connection</span> = <span class="string">mysql+pymysql://neutron:neutron@controller/neutron</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[DEFAULT]</span></span><br><span class="line"><span class="attr">core_plugin</span> = <span class="string">ml2</span></span><br><span class="line"><span class="attr">service_plugins</span> =<span class="string"></span></span><br><span class="line"><span class="attr">transport_url</span> = <span class="string">rabbit://openstack:openstack@controller</span></span><br><span class="line"><span class="attr">auth_strategy</span> = <span class="string">keystone</span></span><br><span class="line"><span class="attr">notify_nova_on_port_status_changes</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">notify_nova_on_port_data_changes</span> = <span class="string">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[keystone_authtoken]</span></span><br><span class="line"><span class="attr">www_authenticate_uri</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">auth_url</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">memcached_servers</span> = <span class="string">controller:11211</span></span><br><span class="line"><span class="attr">auth_type</span> = <span class="string">password</span></span><br><span class="line"><span class="attr">project_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">user_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">project_name</span> = <span class="string">service</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">neutron</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">neutron(neutron用户密码)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[nova]</span></span><br><span class="line"><span class="attr">auth_url</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">auth_type</span> = <span class="string">password</span></span><br><span class="line"><span class="attr">project_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">user_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">region_name</span> = <span class="string">RegionOne</span></span><br><span class="line"><span class="attr">project_name</span> = <span class="string">service</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">nova</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">nova(nova用户密码)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[oslo_concurrency]</span></span><br><span class="line"><span class="attr">lock_path</span> = <span class="string">/var/lib/neutron/tmp</span></span><br></pre></td></tr></table></figure><h5 id="vim-etcneutronpluginsml2ml2_confini"><a class="markdownIt-Anchor" href="#vim-etcneutronpluginsml2ml2_confini"></a> vim /etc/neutron/plugins/ml2/ml2_conf.ini</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[ml2]</span></span><br><span class="line"><span class="attr">type_drivers</span> = <span class="string">flat,vlan</span></span><br><span class="line"><span class="attr">tenant_network_types</span> =<span class="string"></span></span><br><span class="line"><span class="attr">mechanism_drivers</span> = <span class="string">linuxbridge</span></span><br><span class="line"><span class="attr">extension_drivers</span> = <span class="string">port_security</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[ml2_type_flat]</span></span><br><span class="line"><span class="attr">flat_networks</span> = <span class="string">provider</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[securitygroup]</span></span><br><span class="line"><span class="attr">enable_ipset</span> = <span class="string">true</span></span><br></pre></td></tr></table></figure><h5 id="vim-etcneutronpluginsml2linuxbridge_agentini"><a class="markdownIt-Anchor" href="#vim-etcneutronpluginsml2linuxbridge_agentini"></a> vim /etc/neutron/plugins/ml2/linuxbridge_agent.ini</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[linux_bridge]</span></span><br><span class="line"><span class="attr">physical_interface_mappings</span> = <span class="string">provider:ens33(服务器网络接口名)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[vxlan]</span></span><br><span class="line"><span class="attr">enable_vxlan</span> = <span class="string">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[securitygroup]</span></span><br><span class="line"><span class="attr">enable_security_group</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">firewall_driver</span> = <span class="string">neutron.agent.linux.iptables_firewall.IptablesFirewallDriver</span></span><br></pre></td></tr></table></figure><h5 id="edit-kernel-supports"><a class="markdownIt-Anchor" href="#edit-kernel-supports"></a> edit kernel supports</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line">vim /etc/sysctl.conf</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line"></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><h5 id="vim-etcneutrondhcp_agentini"><a class="markdownIt-Anchor" href="#vim-etcneutrondhcp_agentini"></a> vim /etc/neutron/dhcp_agent.ini</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[DEFAULT]</span></span><br><span class="line"><span class="attr">interface_driver</span> = <span class="string">linuxbridge</span></span><br><span class="line"><span class="attr">dhcp_driver</span> = <span class="string">neutron.agent.linux.dhcp.Dnsmasq</span></span><br><span class="line"><span class="attr">enable_isolated_metadata</span> = <span class="string">true</span></span><br></pre></td></tr></table></figure><h5 id="vim-etcneutronmetadata_agentini"><a class="markdownIt-Anchor" href="#vim-etcneutronmetadata_agentini"></a> vim /etc/neutron/metadata_agent.ini</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[DEFAULT]</span></span><br><span class="line"><span class="attr">nova_metadata_host</span> = <span class="string">controller</span></span><br><span class="line"><span class="attr">metadata_proxy_shared_secret</span> = <span class="string">metadata(网络共享密码)</span></span><br></pre></td></tr></table></figure><h5 id="vim-etcnovanovaconf"><a class="markdownIt-Anchor" href="#vim-etcnovanovaconf"></a> vim /etc/nova/nova.conf</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[neutron]</span></span><br><span class="line"><span class="attr">auth_url</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">auth_type</span> = <span class="string">password</span></span><br><span class="line"><span class="attr">project_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">user_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">region_name</span> = <span class="string">RegionOne</span></span><br><span class="line"><span class="attr">project_name</span> = <span class="string">service</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">neutron</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">neutron(neutron用户密码)</span></span><br><span class="line"><span class="attr">service_metadata_proxy</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">metadata_proxy_shared_secret</span> = <span class="string">metadata(网络共享密码)</span></span><br></pre></td></tr></table></figure><h3 id="finalize-installation"><a class="markdownIt-Anchor" href="#finalize-installation"></a> Finalize installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ln -s /etc/neutron/plugins/ml2/ml2_conf.ini /etc/neutron/plugin.ini</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;neutron-db-manage --config-file /etc/neutron/neutron.conf \</span><br><span class="line">  --config-file /etc/neutron/plugins/ml2/ml2_conf.ini upgrade head&quot; neutron</span><br><span class="line"></span><br><span class="line">systemctl restart openstack-nova-api.service</span><br><span class="line"></span><br><span class="line">for op in enable start status;do for service in neutron-server neutron-linuxbridge-agent neutron-dhcp-agent neutron-metadata-agent;do systemctl $op $servicel;done;done</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op neutron-l3-agent;done</span><br></pre></td></tr></table></figure><h2 id="compute-2"><a class="markdownIt-Anchor" href="#compute-2"></a> compute</h2><h3 id="install-and-configure-components-7"><a class="markdownIt-Anchor" href="#install-and-configure-components-7"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-neutron-linuxbridge ebtables ipset -y</span><br></pre></td></tr></table></figure><h4 id="vim-etcneutronneutronconf-2"><a class="markdownIt-Anchor" href="#vim-etcneutronneutronconf-2"></a> vim /etc/neutron/neutron.conf</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[DEFAULT]</span></span><br><span class="line"><span class="attr">transport_url</span> = <span class="string">rabbit://openstack:openstack@controller</span></span><br><span class="line"><span class="attr">auth_strategy</span> = <span class="string">keystone</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[keystone_authtoken]</span></span><br><span class="line"><span class="attr">www_authenticate_uri</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">auth_url</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">memcached_servers</span> = <span class="string">controller:11211</span></span><br><span class="line"><span class="attr">auth_type</span> = <span class="string">password</span></span><br><span class="line"><span class="attr">project_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">user_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">project_name</span> = <span class="string">service</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">neutron</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">neutron(neutron用户密码)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[oslo_concurrency]</span></span><br><span class="line"><span class="attr">lock_path</span> = <span class="string">/var/lib/neutron/tmp</span></span><br></pre></td></tr></table></figure><h4 id="provider-networks-2"><a class="markdownIt-Anchor" href="#provider-networks-2"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/train/install/compute-install-option1-rdo.html">Provider networks</a></h4><h5 id="vim-etcneutronpluginsml2linuxbridge_agentini-2"><a class="markdownIt-Anchor" href="#vim-etcneutronpluginsml2linuxbridge_agentini-2"></a> vim /etc/neutron/plugins/ml2/linuxbridge_agent.ini</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[linux_bridge]</span></span><br><span class="line"><span class="attr">physical_interface_mappings</span> = <span class="string">provider:ens33(服务器网络接口名)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[vxlan]</span></span><br><span class="line"><span class="attr">enable_vxlan</span> = <span class="string">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[securitygroup]</span></span><br><span class="line"><span class="attr">enable_security_group</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">firewall_driver</span> = <span class="string">neutron.agent.linux.iptables_firewall.IptablesFirewallDriver</span></span><br></pre></td></tr></table></figure><h5 id="edit-kernel-supports-2"><a class="markdownIt-Anchor" href="#edit-kernel-supports-2"></a> edit kernel supports</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line">vim /etc/sysctl.conf</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line"></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><h4 id="vim-etcnovanovaconf-2"><a class="markdownIt-Anchor" href="#vim-etcnovanovaconf-2"></a> vim /etc/nova/nova.conf</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[neutron]</span></span><br><span class="line"><span class="attr">auth_url</span> = <span class="string">http://controller:5000</span></span><br><span class="line"><span class="attr">auth_type</span> = <span class="string">password</span></span><br><span class="line"><span class="attr">project_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">user_domain_name</span> = <span class="string">default</span></span><br><span class="line"><span class="attr">region_name</span> = <span class="string">RegionOne</span></span><br><span class="line"><span class="attr">project_name</span> = <span class="string">service</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">neutron</span></span><br><span class="line"><span class="attr">password</span> = <span class="string">neutron(neutron用户密码)</span></span><br></pre></td></tr></table></figure><h3 id="finalize-installation-2"><a class="markdownIt-Anchor" href="#finalize-installation-2"></a> Finalize installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart openstack-nova-compute</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op neutron-linuxbridge-agent;done</span><br></pre></td></tr></table></figure><h2 id="verify-operation-5"><a class="markdownIt-Anchor" href="#verify-operation-5"></a> Verify operation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br></pre></td></tr></table></figure><h3 id="provider-networks-3"><a class="markdownIt-Anchor" href="#provider-networks-3"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/train/install/verify-option1.html">Provider networks</a></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack extension list --network</span><br></pre></td></tr></table></figure><h3 id="self-service-networks"><a class="markdownIt-Anchor" href="#self-service-networks"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/neutron/train/install/verify-option2.html">Self-service networks</a></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack network agent list</span><br></pre></td></tr></table></figure><h1 id="cinder-installation-for-train"><a class="markdownIt-Anchor" href="#cinder-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/cinder/train/install/">Cinder installation for Train</a></h1><h2 id="controller-5"><a class="markdownIt-Anchor" href="#controller-5"></a> controller</h2><h3 id="prerequisites-7"><a class="markdownIt-Anchor" href="#prerequisites-7"></a> Prerequisites</h3><h4 id="create-database-5"><a class="markdownIt-Anchor" href="#create-database-5"></a> Create Database</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p123456</span><br><span class="line"></span><br><span class="line">CREATE DATABASE cinder;</span><br><span class="line"></span><br><span class="line">GRANT ALL PRIVILEGES ON cinder.* TO &#x27;cinder&#x27;@&#x27;localhost&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;cinder&#x27;;</span><br><span class="line">GRANT ALL PRIVILEGES ON cinder.* TO &#x27;cinder&#x27;@&#x27;%&#x27; \</span><br><span class="line">  IDENTIFIED BY &#x27;cinder&#x27;;</span><br><span class="line"></span><br><span class="line">exit;</span><br></pre></td></tr></table></figure><h4 id="configure-user-and-endpoints-5"><a class="markdownIt-Anchor" href="#configure-user-and-endpoints-5"></a> Configure User and Endpoints</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置cinder用户密码</span></span><br><span class="line">openstack user create --domain default --password-prompt cinder</span><br><span class="line"></span><br><span class="line">openstack role add --project service --user cinder admin</span><br><span class="line"></span><br><span class="line">openstack service create --name cinderv2 \</span><br><span class="line">  --description &quot;OpenStack Block Storage&quot; volumev2</span><br><span class="line">openstack service create --name cinderv3 \</span><br><span class="line">  --description &quot;OpenStack Block Storage&quot; volumev3</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev2 public http://controller:8776/v2/%\(project_id\)s</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev2 internal http://controller:8776/v2/%\(project_id\)s</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev2 admin http://controller:8776/v2/%\(project_id\)s</span><br><span class="line"></span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev3 public http://controller:8776/v3/%\(project_id\)s</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev3 internal http://controller:8776/v3/%\(project_id\)s</span><br><span class="line">openstack endpoint create --region RegionOne \</span><br><span class="line">  volumev3 admin http://controller:8776/v3/%\(project_id\)s</span><br></pre></td></tr></table></figure><h3 id="install-and-configure-components-8"><a class="markdownIt-Anchor" href="#install-and-configure-components-8"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-cinder -y</span><br><span class="line"></span><br><span class="line">vim /etc/cinder/cinder.conf</span><br><span class="line">[DEFAULT]</span><br><span class="line">transport_url = rabbit://openstack:openstack@controller</span><br><span class="line">auth_strategy = keystone</span><br><span class="line">my_ip = 10.10.10.101</span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://cinder:cinder@controller/cinder</span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://controller:5000</span><br><span class="line">auth_url = http://controller:5000</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = default</span><br><span class="line">user_domain_name = default</span><br><span class="line">project_name = service</span><br><span class="line">username = cinder</span><br><span class="line">password = cinder(cinder用户密码)</span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/cinder/tmp</span><br><span class="line"></span><br><span class="line">su -s /bin/sh -c &quot;cinder-manage db sync&quot; cinder</span><br></pre></td></tr></table></figure><h3 id="configure-compute-to-use-block-storage"><a class="markdownIt-Anchor" href="#configure-compute-to-use-block-storage"></a> Configure Compute to use Block Storage[</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nova/nova.conf</span><br><span class="line">[cinder]</span><br><span class="line">os_region_name = RegionOne</span><br></pre></td></tr></table></figure><h3 id="finalize-installation-3"><a class="markdownIt-Anchor" href="#finalize-installation-3"></a> Finalize installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for op in restart status;do systemctl $op openstack-nova-api;done</span><br><span class="line"></span><br><span class="line">for op in enable restart status;do for service in openstack-cinder-api openstack-cinder-scheduler;do systemctl $op $service;done;done</span><br></pre></td></tr></table></figure><h2 id="block"><a class="markdownIt-Anchor" href="#block"></a> block</h2><h3 id="prerequisites-8"><a class="markdownIt-Anchor" href="#prerequisites-8"></a> Prerequisites</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">yum install lvm2 device-mapper-persistent-data</span><br><span class="line"></span><br><span class="line">for op in enable start status;do systemctl $op lvm2-lvmetad;done</span><br><span class="line"></span><br><span class="line">pvcreate /dev/sdb</span><br><span class="line"></span><br><span class="line">vgcreate cinder-volumes /dev/sdb</span><br><span class="line"></span><br><span class="line">vim /etc/lvm/lvm.conf</span><br><span class="line">devices &#123;</span><br><span class="line">...</span><br><span class="line">filter = [ &quot;a/sdb/&quot;, &quot;r/.*/&quot;]</span><br></pre></td></tr></table></figure><h3 id="install-and-configure-components-9"><a class="markdownIt-Anchor" href="#install-and-configure-components-9"></a> Install and configure components</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-cinder targetcli python-keystone -y</span><br><span class="line"></span><br><span class="line">vim /etc/cinder/cinder.conf</span><br><span class="line">[DEFAULT]</span><br><span class="line">auth_strategy = keystone</span><br><span class="line">transport_url = rabbit://openstack:openstack@controller</span><br><span class="line">my_ip = 10.10.10.103</span><br><span class="line">enabled_backends = lvm</span><br><span class="line">glance_api_servers = http://controller:9292</span><br><span class="line">[database]</span><br><span class="line">connection = mysql+pymysql://cinder:cinder@controller/cinder</span><br><span class="line">[keystone_authtoken]</span><br><span class="line">www_authenticate_uri = http://controller:5000</span><br><span class="line">auth_url = http://controller:5000</span><br><span class="line">memcached_servers = controller:11211</span><br><span class="line">auth_type = password</span><br><span class="line">project_domain_name = default</span><br><span class="line">user_domain_name = default</span><br><span class="line">project_name = service</span><br><span class="line">username = cinder</span><br><span class="line">password = cinder</span><br><span class="line">[lvm]</span><br><span class="line">volume_driver = cinder.volume.drivers.lvm.LVMVolumeDriver</span><br><span class="line">volume_group = cinder-volumes</span><br><span class="line">target_protocol = iscsi</span><br><span class="line">target_helper = lioadm</span><br><span class="line">[oslo_concurrency]</span><br><span class="line">lock_path = /var/lib/cinder/tmp</span><br></pre></td></tr></table></figure><h3 id="finalize-installation-4"><a class="markdownIt-Anchor" href="#finalize-installation-4"></a> Finalize installation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for op in enable restart status;do for service in openstack-cinder-volume target;do systemctl $op $service;done;done</span><br></pre></td></tr></table></figure><h2 id="verify-cinder-operation"><a class="markdownIt-Anchor" href="#verify-cinder-operation"></a> Verify Cinder operation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line">openstack volume service list</span><br></pre></td></tr></table></figure><h1 id="horizon-installation-for-train"><a class="markdownIt-Anchor" href="#horizon-installation-for-train"></a> <a target="_blank" rel="noopener" href="https://docs.openstack.org/horizon/train/install/">Horizon installation for Train</a></h1><h2 id="install-and-configure-components-10"><a class="markdownIt-Anchor" href="#install-and-configure-components-10"></a> Install and configure components</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">yum install openstack-dashboard -y</span><br><span class="line"></span><br><span class="line">vim /etc/openstack-dashboard/local_settings</span><br><span class="line"></span><br><span class="line">OPENSTACK_HOST = &quot;controller&quot;</span><br><span class="line">ALLOWED_HOSTS = [&#x27;*&#x27;]</span><br><span class="line">SESSION_ENGINE = &#x27;django.contrib.sessions.backends.cache&#x27;</span><br><span class="line">CACHES = &#123;</span><br><span class="line">    &#x27;default&#x27;: &#123;</span><br><span class="line">         &#x27;BACKEND&#x27;: &#x27;django.core.cache.backends.memcached.MemcachedCache&#x27;,</span><br><span class="line">         &#x27;LOCATION&#x27;: &#x27;controller:11211&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">OPENSTACK_KEYSTONE_URL = &quot;http://%s:5000/v3&quot; % OPENSTACK_HOST</span><br><span class="line">OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = True</span><br><span class="line">OPENSTACK_API_VERSIONS = &#123;</span><br><span class="line">    &quot;identity&quot;: 3,</span><br><span class="line">    &quot;image&quot;: 2,</span><br><span class="line">    &quot;volume&quot;: 3,</span><br><span class="line">&#125;</span><br><span class="line">OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = &quot;Default&quot;</span><br><span class="line">OPENSTACK_KEYSTONE_DEFAULT_ROLE = &quot;user&quot;</span><br><span class="line">OPENSTACK_NEUTRON_NETWORK = &#123;</span><br><span class="line">    ...</span><br><span class="line">    &#x27;enable_router&#x27;: False,</span><br><span class="line">    &#x27;enable_quotas&#x27;: False,</span><br><span class="line">    &#x27;enable_distributed_router&#x27;: False,</span><br><span class="line">    &#x27;enable_ha_router&#x27;: False,</span><br><span class="line">    &#x27;enable_lb&#x27;: False,</span><br><span class="line">    &#x27;enable_firewall&#x27;: False,</span><br><span class="line">    &#x27;enable_vpn&#x27;: False,</span><br><span class="line">    &#x27;enable_fip_topology_check&#x27;: False,</span><br><span class="line">&#125;</span><br><span class="line">TIME_ZONE = &quot;Asia/Shanghai&quot;</span><br><span class="line">WEBROOT = &#x27;/dashboard/&#x27;</span><br><span class="line"></span><br><span class="line">vim  /etc/httpd/conf.d/openstack-dashboard.conf</span><br><span class="line">WSGIApplicationGroup %&#123;GLOBAL&#125;</span><br></pre></td></tr></table></figure><h2 id="finalize-installation-5"><a class="markdownIt-Anchor" href="#finalize-installation-5"></a> Finalize installation</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart httpd.service memcached.service</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">访问http://主控节点IP/dashboard/,域:default</span></span><br></pre></td></tr></table></figure><h1 id="launch-an-instance可以通过-dashboard-实现"><a class="markdownIt-Anchor" href="#launch-an-instance可以通过-dashboard-实现"></a> Launch an instance（可以通过 dashboard 实现）</h1><h2 id="create-virtual-networks"><a class="markdownIt-Anchor" href="#create-virtual-networks"></a> Create virtual networks</h2><h3 id="provider-network"><a class="markdownIt-Anchor" href="#provider-network"></a> Provider network</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">. admin-openrc</span><br><span class="line"></span><br><span class="line">openstack network create  --share --external \</span><br><span class="line">  --provider-physical-network provider \</span><br><span class="line">  --provider-network-type flat provider</span><br><span class="line"></span><br><span class="line">openstack subnet create --network provider \</span><br><span class="line">  --allocation-pool start=192.168.40.101,end=192.168.40.250 \</span><br><span class="line">  --dns-nameserver 8.8.8.8 --gateway 192.168.40.1 \</span><br><span class="line">  --subnet-range 192.168.40.0/24 provider</span><br></pre></td></tr></table></figure><h3 id="self-service-network"><a class="markdownIt-Anchor" href="#self-service-network"></a> Self-service network</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">. demo-openrc</span><br><span class="line"></span><br><span class="line">openstack network create selfservice</span><br><span class="line"></span><br><span class="line">openstack subnet create --network selfservice \</span><br><span class="line">  --dns-nameserver 8.8.4.4 --gateway 172.16.1.1 \</span><br><span class="line">  --subnet-range 172.16.1.0/24 selfservice</span><br><span class="line"></span><br><span class="line">openstack router create router</span><br><span class="line">openstack router add subnet router selfservice</span><br><span class="line">openstack router set router --external-gateway provider</span><br><span class="line"></span><br><span class="line">. admin-openrc</span><br><span class="line">ip netns</span><br><span class="line">openstack port list --router router</span><br></pre></td></tr></table></figure><h2 id="create-m1nano-flavor"><a class="markdownIt-Anchor" href="#create-m1nano-flavor"></a> Create m1.nano flavor</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for op in enable satrt status;do for service in libvirtd openstack-nova-compute;do systemctl $op $service;done;done</span><br><span class="line"></span><br><span class="line">openstack flavor create --id 0 --vcpus 1 --ram 64 --disk 1 m1.nano</span><br><span class="line">openstack flavor create --id 0 --vcpus 1 --ram 1024 --disk 10 m2.nano</span><br></pre></td></tr></table></figure><h2 id="generate-a-key-pair"><a class="markdownIt-Anchor" href="#generate-a-key-pair"></a> Generate a key pair</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">. demo-openrc</span><br><span class="line">ssh-keygen -q -N &quot;&quot;</span><br><span class="line">openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey</span><br><span class="line">openstack keypair list</span><br></pre></td></tr></table></figure><h2 id="add-security-group-rules"><a class="markdownIt-Anchor" href="#add-security-group-rules"></a> Add security group rules</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openstack security group rule create --proto icmp default</span><br><span class="line">openstack security group rule create --proto tcp --dst-port 22 default</span><br></pre></td></tr></table></figure><h2 id="launch-an-instance"><a class="markdownIt-Anchor" href="#launch-an-instance"></a> Launch an instance</h2><h3 id="provider-network-2"><a class="markdownIt-Anchor" href="#provider-network-2"></a> Provider network</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">. demo-openrc</span><br><span class="line">openstack flavor list</span><br><span class="line">openstack image list</span><br><span class="line">openstack network list</span><br><span class="line">openstack security group list</span><br><span class="line"></span><br><span class="line">openstack server create --flavor m1.nano --image cirros \</span><br><span class="line">  --nic net-id=PROVIDER_NET_ID --security-group default \</span><br><span class="line">  --key-name mykey provider-instance</span><br><span class="line">openstack server list</span><br><span class="line">openstack console url show provider-instance</span><br></pre></td></tr></table></figure><h3 id="self-service-network-2"><a class="markdownIt-Anchor" href="#self-service-network-2"></a> Self-service network</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openstack server create --flavor m1.nano --image cirros \</span><br><span class="line">  --nic net-id=b364d40b-0e57-4b32-9949-db83666f0f57 --security-group default \</span><br><span class="line">  --key-name mykey newserver</span><br></pre></td></tr></table></figure><h2 id="修改实例默认密码controller"><a class="markdownIt-Anchor" href="#修改实例默认密码controller"></a> 修改实例默认密码(controller)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nova/nova.conf</span><br><span class="line">inject_password=True</span><br><span class="line"></span><br><span class="line">vim /etc/openstack-dashboard/local_settings</span><br><span class="line">OPENSTACK_HYPERVISOR_FEATURES = &#123;</span><br><span class="line">&#x27;can_set_password&#x27;: True</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">systemctl restart openstack-nova-*</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建实例时写入以下脚本，并勾选配置驱动</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">passwd root&lt;&lt;EOF</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></div></div><script src="https://unpkg.com/mermaid@latest/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({startOnload:!0})</script></article><div class="post__foot"><div class="like-author"><input type="checkbox" id="likeCode"><div class="author-face"><img height="100px" width="100px" id="front-face" alt="author face" src="/images/avatar.jpg"> <img height="100px" width="100px" id="back-face" alt="like code" src="/images/wechatpay.png"></div><div class="like-text">俾Mucy食[凍乾]~(￣▽￣)~*</div><label for="likeCode" class="like-btn"><svg viewBox="0 0 1024 1024" width="20px" style="margin-right:10px" height="20px"><path d="M466.88 908.96L113.824 563.296a270.08 270.08 0 0 1 0-387.392c108.8-106.56 284.896-106.56 393.696 0 1.504 1.472 2.976 2.944 4.448 4.48 1.472-1.536 2.944-3.008 4.448-4.48 108.8-106.56 284.896-106.56 393.696 0a269.952 269.952 0 0 1 34.016 347.072l-387.392 385.6a64 64 0 0 1-89.92 0.384z" p-id="13650" fill="#ee4242"/></svg> 心水</label></div><div class="post-nav"><a class="post-nav-item-left" href="/posts/c1d5d64c.html"><div class="text-align"><svg t="1670570876164" class="icon" viewBox="0 0 1024 1024" width="16" height="16"><path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/></svg> <span class="text-small">上一篇</span></div><div>搭建Hexo博客</div></a><div class="vhr"></div><a class="post-nav-item-right" href="/posts/d297681f.html"><div class="text-align"><span class="text-small">下一篇</span> <svg t="1670570876164" class="icon" viewBox="0 0 1024 1024" transform="scale(-1,-1)" width="16" height="16"><path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" p-id="14596"/></svg></div>通过二进制方式搭建Kubernetes集群</a></div><div class="related-post"><div class="related__head"><a href="/tags/openstack/" class="post-tag">#openstack</a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" class="post-tag">#虚拟化</a></div><div class="realated__body"><div class="null"><div class="null-item"><div class="null-title"><a href="\posts\6348717a.html" title="Commands" rel="bookmark">Commands</a></div><div class="null-excerpt"><p></p><blockquote><p>  总结一些常用命令</p></blockquote><p></p></div></div><div class="null-item"><div class="null-title"><a href="\posts\688c3b79.html" title="通过Kubeadm搭建Kubernetes单主多从集群" rel="bookmark">通过Kubeadm搭建Kubernetes单主多从集群</a></div><div class="null-excerpt"><p></p><blockquote><p>  学习搭建使用 <code>Kubeadm</code> 搭建 <code>Kubernetes</code> 单主多从集群</p></blockquote><p></p></div></div></div></div></div></div></div><div class="foot"><div class="foot-inner"><div class="foot__head"><div class="foot-line"><div class="matts">用</div><div class="matts">捨</div><div class="matts">由</div><div class="matts">時</div></div><div class="foot-line"><div class="matts">行</div><div class="matts">藏</div><div class="matts">在</div><div class="matts">我</div></div></div><div class="foot__body"><div class="foot-item"><div class="foot-item__head">账号</div><div class="foot-item__body"><div class="text"><img alt="link" height="20px" width="20px" src="/images/icon/icon-github.svg"> <a class="foot-link" target="_blank" rel="noopener" href="https://github.com/limerencist">github</a></div></div></div><div class="foot-item"><div class="foot-item__head">联系</div><div class="foot-item__body"><div class="text"><img alt="link" height="20px" width="20px" src="/images/icon/icon-email.svg"> <a class="foot-link" href="mailto:limerencist@gmail.com">limerencist@gmail.com</a></div></div></div></div><div class="copyright"><a href="https://limerencist.github.io">失落之地</a> &nbsp;|&nbsp;由&nbsp;<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>&nbsp;及&nbsp; <svg width="20" height="20" viewBox="0 0 725 725"><path fill-rule="evenodd" fill="rgb(221, 221, 221)" d="M145.870,236.632 L396.955,103.578 L431.292,419.44 L156.600,522.53 L145.870,236.632 Z"/><path fill-rule="evenodd" fill="rgb(159, 159, 159)" d="M396.955,103.578 L564.345,234.486 L611.558,513.469 L431.292,419.44 L396.955,103.578 Z"/><path fill-rule="evenodd" fill="rgb(0, 0, 0)" d="M431.292,419.44 L611.558,513.469 L358.327,595.18 L156.600,522.53 L431.292,419.44 Z"/></svg> <a target="_blank" rel="noopener" href="https://github.com/hooozen/hexo-theme-tranquility">致远</a>&nbsp;驱动</div></div></div><script src="/js/search.js"></script><script>searchInitialize("/search.json")</script></body></html>